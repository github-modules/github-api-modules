{"name":"glob-github","version":"1.2.0","description":"Run glob expressions against the Github Repo Contents API and return the matching files and metadata; with caching.","main":"index.js","scripts":{"test":"echo \"Error: no test specified\" && exit 1"},"repository":"https://github.com/mixu/glob-github","keywords":["github","glob","repo","contents","api"],"license":"BSD-3-Clause","homepage":"https://github.com/mixu/glob-github#readme","dependencies":{"github":"~0.2.4","glob-parse":"0.0.1","microee":"0.0.6","wildglob":"~0.1.0","xtend":"~4.0.0"},"gitHead":"e9e4919e8509b54765b39b7b3f661c5524aa1c48","versions":[{"number":"1.0.0","date":"2015-10-21T06:27:25.588Z"},{"number":"1.1.0","date":"2015-10-22T05:46:57.617Z"},{"number":"1.1.1","date":"2015-10-28T03:14:46.155Z"},{"number":"1.2.0","date":"2015-10-28T03:46:33.608Z"}],"readme":"# glob-github\n\nRun glob expressions against the Github Repo Contents API and return the matching files and metadata; with caching.\n\n## Features\n\n- you can avoid performing a full git clone if you use [the Github Contents API](https://developer.github.com/v3/repos/contents/) to fetch files, but using it to traverse individual file paths is tedious; why not just run a glob expression against a specific Github repository and get the resulting API results?\n- you can use any glob expression like `**/*.md` to match files\n- supports in-memory caching so that the same file paths are never requested multiple times; you can easily write the cache to disk as a JSON file if you want long term caching as it is a simple hash\n- (since v1.1.0) deduplicates ongoing requests, so that even when executing multiple globs at the same time only one HTTP request is made for each resource\n\n## Installation\n\n```\nnpm install --save glob-github\n```\n\n## Usage\n\nHere's a quick example:\n\n```\nvar glob = require('glob-github');\n\nglob({\n  user: 'mixu',\n  repo: 'singlepageappbook',\n  glob: '**/*.md',\n  authenticate: {\n    type: 'oauth',\n    token: '<AUTH TOKEN HERE>'\n  }\n}, function(err, results, meta) {\n  console.log(err, results, meta);\n  // results is an array of Github Get Contents API call results:\n  // [ { type: 'file', name: 'index.md', path: 'input/index.md', ... }]\n  // meta:\n  // { limit: 4774, cacheHits: 0, apiCalls: 16 }\n});\n```\n\n`glob(opts, onDone)`, where `opts` is an options hash containing:\n\n- `opts.user`: Github username\n- `opts.repo`: Github repo\n- `opts.branch`: Github branch (since `v1.2.0`); defaults to master\n- `opts.glob`: glob expression to match against\n- `opts.authenticate`: a hash passed to [`node-github`](https://github.com/mikedeboer/node-github#authentication)\n- `opts.cache`: (Optional). A hash that can be reused across calls, pass in a `{}` on the first usage and keep passing the same hash in every time to keep using the cache. Note that the results are automatically cached so you only need to pass this if you want to, say, write the cache to disk or something.\n- `opts.github`: (Optional). An instance of [`node-github`](https://github.com/mikedeboer/node-github) that you have configured to your liking.\n\nThe `onDone(err, results, meta)` callback receives three arguments:\n\n- `err`: an error, if any\n- `results`: an array of results which match the given glob expression as returned from [the Github Get Contents API](https://developer.github.com/v3/repos/contents/#get-contents); see the link for examples.\n- `meta`: an object containing metadata:\n  - `meta.limit`: the smallest Github API `x-rate-limit` header value that has been received\n  - `meta.cacheHits`: the number of Github API calls that were fulfilled from the cache to resolve the glob expression\n  - `meta.githubAPI`: the number of Github API calls that were made to resolve the glob expression\n\n## Caching\n\nIf you make the same call (or another glob expression resolution) against the same repo, `glob-github` will attempt to fulfill matches from the cache:\n\n```\nvar glob = require('glob-github');\nvar config = {\n  user: 'mixu',\n  repo: 'singlepageappbook',\n  glob: '**/*.md',\n  authenticate: {\n    type: 'oauth',\n    token: '<AUTH TOKEN HERE>'\n  }\n};\n\nglob(config, function(err, results, meta) {\n  // should show some number of meta.githubAPI\n  console.log(meta);\n  glob(config, function(err, results, meta) {\n    // should be fulfilled completely from the cache!\n    console.log(meta);\n  });\n});\n```\n\n## Deduplication\n\nConcurrent calls are deduplicated: if a request for a specific Github endpoint (e.g. username + repo + path combination) is already pending, then any concurrent requests simply wait for that request to complete rather than making a new request.\n\n```\nvar glob = require('glob-github');\nvar config = { ... };\n\nglob(config, function(err, results, meta) {\n  console.log(err, results.length, meta);\n});\n\nglob(config, function(err, results, meta) {\n  console.log(err, results.length, meta);\n});\n```\n\nYou should see something like:\n\n```\nnull 16 { limit: 10, cacheHits: 10, apiCalls: 6 }\nnull 16 { limit: 10, cacheHits: 6, apiCalls: 10 }\n```\n\nNote how the 16 API calls needed to resolve this `**/*.md` glob are divided between the two concurrent `glob()` calls so that only 16 requests are made and the duplicate requests are served from the cache.\n","created":"2015-10-21T06:27:25.588Z","modified":"2015-10-28T03:46:33.608Z","lastPublisher":{"name":"mixu","email":"mixu@mixu.net"},"owners":[{"name":"mixu","email":"mixu@mixu.net"}],"other":{"_attachments":{},"_from":".","_id":"glob-github","_nodeVersion":"0.12.6","_npmUser":{"name":"mixu","email":"mixu@mixu.net"},"_npmVersion":"2.11.2","_rev":"1-6aacf747d891a8281f641f076fca01b5","_shasum":"3dcccee80aeff2eb8d1bacabf8aef2a8fff44c65","author":{"name":"Mikito Takada","email":"mikito.takada@gmail.com","url":"http://mixu.net/"},"bugs":{"url":"https://github.com/mixu/glob-github/issues"},"directories":{},"dist-tags":{"latest":"1.2.0"},"dist":{"shasum":"3dcccee80aeff2eb8d1bacabf8aef2a8fff44c65","tarball":"http://registry.npmjs.org/glob-github/-/glob-github-1.2.0.tgz"},"maintainers":[{"name":"mixu","email":"mixu@mixu.net"}],"readmeFilename":"readme.md","time":{"modified":"2015-10-28T03:46:33.608Z","created":"2015-10-21T06:27:25.588Z","1.0.0":"2015-10-21T06:27:25.588Z","1.1.0":"2015-10-22T05:46:57.617Z","1.1.1":"2015-10-28T03:14:46.155Z","1.2.0":"2015-10-28T03:46:33.608Z"}}}